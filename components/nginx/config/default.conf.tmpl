# Declares the size of a request's body. This is mainly used to allow large blueprints to be uploaded.
client_max_body_size 0m;

# Overcoming the renowned http://stackoverflow.com/questions/19238122/nginx-with-ubuntu-and-rails-on-digital-ocean
types_hash_max_size 4096;

# Upstream for Cloudify's Rest Service.
<% if rest_services %>
upstream cloudify-rest {
    <% for rest_service in rest_services -%>
        server << rest_service.ip >>:<< rest_service.port >>;
    <% endfor %>
}
<% endif %>

<% if fileservers %>
upstream cloudify-resources {
    <% for fileserver in fileservers -%>
        server << fileserver.ip >>:53229;
    <% endfor %>
}
<% endif %>

# XXX rest_protocol from runtime props
include "/etc/nginx/conf.d/http-rest-server.cloudify";
include "/etc/nginx/conf.d/http-file-server.cloudify";
